<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Firefox Extras: Refined Findbar</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="A beautiful, customizable findbar for Firefox - centered, fixed, scalable, and fully customizable via SCSS."
    />
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🦊</text></svg>"
    />

    <style>
      :root {
        --primary-color: #ff9500;
        --primary-dark: #cc7700;
        --secondary-color: #0078d4;
        --secondary-dark: #005a9e;
        --background: #ffffff;
        --surface: #f8f9fa;
        --surface-hover: #e9ecef;
        --text-primary: #212529;
        --text-secondary: #6c757d;
        --border: #dee2e6;
        --border-light: #f1f3f4;
        --success: #28a745;
        --warning: #ffc107;
        --danger: #dc3545;
        --shadow: rgba(0, 0, 0, 0.1);
        --shadow-lg: rgba(0, 0, 0, 0.15);
        --border-radius: 8px;
        --border-radius-lg: 12px;
        --transition: all 0.2s ease;
      }

      @media (prefers-color-scheme: dark) {
        :root {
          --background: #1a1a1a;
          --surface: #2d2d2d;
          --surface-hover: #3a3a3a;
          --text-primary: #ffffff;
          --text-secondary: #b0b0b0;
          --border: #404040;
          --border-light: #353535;
          --shadow: rgba(0, 0, 0, 0.3);
          --shadow-lg: rgba(0, 0, 0, 0.4);
        }
      }

      * {
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        line-height: 1.6;
        margin: 0;
        padding: 0;
        background: var(--background);
        color: var(--text-primary);
        font-size: 16px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
      }

      /* Header */
      .header {
        background: var(--surface);
        border-bottom: 1px solid var(--border);
        padding: 1rem 0;
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(10px);
      }

      .header-content {
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 1rem;
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-size: 1.5rem;
        font-weight: bold;
        text-decoration: none;
        color: var(--text-primary);
      }

      .logo .icon {
        font-size: 2rem;
      }

      .nav {
        display: flex;
        gap: 2rem;
        list-style: none;
        margin: 0;
        padding: 0;
      }

      .nav a {
        color: var(--text-secondary);
        text-decoration: none;
        font-weight: 500;
        transition: var(--transition);
        padding: 0.5rem 0;
        border-bottom: 2px solid transparent;
      }

      .nav a:hover {
        color: var(--primary-color);
        border-bottom-color: var(--primary-color);
      }

      /* Hero Section */
      .hero {
        padding: 4rem 0;
        text-align: center;
        background: linear-gradient(135deg, var(--surface) 0%, var(--background) 100%);
      }

      .hero h1 {
        font-size: 3rem;
        margin: 0 0 1rem 0;
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .hero p {
        font-size: 1.25rem;
        color: var(--text-secondary);
        margin: 0 0 2rem 0;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
      }

      .cta-buttons {
        display: flex;
        gap: 1rem;
        justify-content: center;
        flex-wrap: wrap;
      }

      /* Buttons */
      .btn {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1.5rem;
        border: none;
        border-radius: var(--border-radius);
        font-size: 1rem;
        font-weight: 600;
        text-decoration: none;
        text-align: center;
        cursor: pointer;
        transition: var(--transition);
        white-space: nowrap;
      }

      .btn-primary {
        background: var(--primary-color);
        color: white;
      }

      .btn-primary:hover {
        background: var(--primary-dark);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px var(--shadow-lg);
      }

      .btn-secondary {
        background: var(--secondary-color);
        color: white;
      }

      .btn-secondary:hover {
        background: var(--secondary-dark);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px var(--shadow-lg);
      }

      .btn-outline {
        background: transparent;
        color: var(--text-primary);
        border: 2px solid var(--border);
      }

      .btn-outline:hover {
        background: var(--surface-hover);
        border-color: var(--primary-color);
        color: var(--primary-color);
      }

      /* Sections */
      .section {
        padding: 4rem 0;
      }

      .section h2 {
        font-size: 2.5rem;
        margin: 0 0 1rem 0;
        text-align: center;
      }

      .section p {
        font-size: 1.125rem;
        color: var(--text-secondary);
        text-align: center;
        max-width: 700px;
        margin: 0 auto 3rem auto;
      }

      /* Features Grid */
      .features {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        margin: 3rem 0;
      }

      .feature {
        background: var(--surface);
        padding: 2rem;
        border-radius: var(--border-radius-lg);
        border: 1px solid var(--border-light);
        text-align: center;
        transition: var(--transition);
      }

      .feature:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 25px var(--shadow-lg);
      }

      .feature-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
      }

      .feature h3 {
        margin: 0 0 1rem 0;
        color: var(--text-primary);
      }

      .feature p {
        margin: 0;
        color: var(--text-secondary);
        text-align: left;
      }

      /* Playground Section */
      .playground {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--border-radius-lg);
        overflow: hidden;
        margin: 2rem 0;
      }

      .playground-header {
        background: var(--primary-color);
        color: white;
        padding: 1.5rem 2rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 1rem;
      }

      .playground-header h3 {
        margin: 0;
        font-size: 1.5rem;
      }

      .playground-content {
        padding: 2rem;
      }

      .playground-description {
        background: var(--warning);
        color: #856404;
        padding: 1rem 1.5rem;
        border-radius: var(--border-radius);
        margin-bottom: 1.5rem;
        border-left: 4px solid #d39e00;
      }

      .playground-description strong {
        display: block;
        margin-bottom: 0.5rem;
      }

      .code-container {
        position: relative;
        margin: 1.5rem 0;
      }

      .code-textarea {
        width: 100%;
        min-height: 400px;
        font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Code', 'Droid Sans Mono', 'Source Code Pro', monospace;
        font-size: 14px;
        line-height: 1.5;
        padding: 1.5rem;
        border: 2px solid var(--border);
        border-radius: var(--border-radius);
        background: var(--background);
        color: var(--text-primary);
        resize: vertical;
        transition: var(--transition);
      }

      .code-textarea:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(255, 149, 0, 0.1);
      }

      .code-actions {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
        margin-top: 1.5rem;
      }

      /* Installation Steps */
      .installation {
        background: var(--surface);
        border-radius: var(--border-radius-lg);
        padding: 2rem;
        margin: 2rem 0;
      }

      .installation h3 {
        margin: 0 0 1.5rem 0;
        color: var(--text-primary);
      }

      .installation-methods {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
      }

      .method {
        background: var(--background);
        border: 1px solid var(--border);
        border-radius: var(--border-radius);
        padding: 1.5rem;
      }

      .method h4 {
        margin: 0 0 1rem 0;
        color: var(--primary-color);
      }

      .method ol {
        margin: 0;
        padding-left: 1.5rem;
      }

      .method li {
        margin-bottom: 0.5rem;
      }

      .code-block {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--border-radius);
        padding: 1rem;
        font-family: monospace;
        font-size: 0.9rem;
        margin: 0.5rem 0;
        overflow-x: auto;
      }

      /* Footer */
      .footer {
        background: var(--surface);
        border-top: 1px solid var(--border);
        padding: 3rem 0;
        margin-top: 4rem;
        text-align: center;
      }

      .footer-content {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
        margin-bottom: 2rem;
      }

      .footer-section h4 {
        margin: 0 0 1rem 0;
        color: var(--text-primary);
      }

      .footer-section ul {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .footer-section li {
        margin-bottom: 0.5rem;
      }

      .footer-section a {
        color: var(--text-secondary);
        text-decoration: none;
        transition: var(--transition);
      }

      .footer-section a:hover {
        color: var(--primary-color);
      }

      .footer-bottom {
        border-top: 1px solid var(--border);
        padding-top: 1.5rem;
        color: var(--text-secondary);
        font-size: 0.9rem;
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .container {
          padding: 0 1rem;
        }

        .hero h1 {
          font-size: 2rem;
        }

        .hero p {
          font-size: 1rem;
        }

        .section h2 {
          font-size: 2rem;
        }

        .nav {
          gap: 1rem;
        }

        .cta-buttons {
          flex-direction: column;
          align-items: center;
        }

        .code-actions {
          flex-direction: column;
        }

        .btn {
          width: 100%;
          justify-content: center;
        }
      }

      /* Animations */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .fade-in-up {
        animation: fadeInUp 0.6s ease-out;
      }

      /* Status indicators */
      .status {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.875rem;
        font-weight: 600;
      }

      .status-success {
        background: rgba(40, 167, 69, 0.1);
        color: var(--success);
        border: 1px solid rgba(40, 167, 69, 0.2);
      }

      .status-loading {
        background: rgba(255, 193, 7, 0.1);
        color: var(--warning);
        border: 1px solid rgba(255, 193, 7, 0.2);
      }

      /* Scroll behavior */
      html {
        scroll-behavior: smooth;
      }

      /* Focus styles for accessibility */
      .btn:focus-visible,
      .code-textarea:focus-visible {
        outline: 2px solid var(--primary-color);
        outline-offset: 2px;
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="container">
        <div class="header-content">
          <a href="#" class="logo">
            <span class="icon">🦊</span>
            <span>Firefox Extras</span>
          </a>
          <nav>
            <ul class="nav">
              <li><a href="#features">Features</a></li>
              <li><a href="#playground">Playground</a></li>
              <li><a href="#install">Install</a></li>
              <li>
                <a href="https://github.com/AlexanderReaper7/firefox-extras" target="_blank" rel="noopener">GitHub</a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
      <div class="container">
        <h1 class="fade-in-up">Refined Findbar</h1>
        <p class="fade-in-up">
          A beautiful, customizable findbar for Firefox. Centered, fixed, scalable, and fully customizable via SCSS.
        </p>
        <div class="cta-buttons fade-in-up">
          <a href="#playground" class="btn btn-primary"> 🎨 Try Playground </a>
          <a href="#install" class="btn btn-secondary"> 📦 Install Now </a>
          <a
            href="https://github.com/AlexanderReaper7/firefox-extras"
            target="_blank"
            rel="noopener"
            class="btn btn-outline"
          >
            📚 View Source
          </a>
        </div>
      </div>
    </section>

    <!-- Features Section -->
    <section id="features" class="section">
      <div class="container">
        <h2>Why Choose Firefox Refined Findbar?</h2>
        <p>
          Transform your Firefox search experience with a modern, fully customizable findbar that adapts to your
          workflow.
        </p>

        <div class="features">
          <div class="feature fade-in-up">
            <div class="feature-icon">🎯</div>
            <h3>Centered & Fixed</h3>
            <p>
              The findbar stays centered and fixed in your viewport, making it easy to access without disrupting your
              browsing flow. No more hunting for the search box!
            </p>
          </div>

          <div class="feature fade-in-up">
            <div class="feature-icon">📐</div>
            <h3>Scalable Design</h3>
            <p>
              Adjust the size to match your preferences. From compact to large, the findbar scales beautifully while
              maintaining perfect proportions and readability.
            </p>
          </div>

          <div class="feature fade-in-up">
            <div class="feature-icon">🎨</div>
            <h3>Fully Customizable</h3>
            <p>
              Every aspect is configurable via SCSS. Change colors, positioning, behavior, button grouping, and element
              order to create your perfect search experience.
            </p>
          </div>

          <div class="feature fade-in-up">
            <div class="feature-icon">⚡</div>
            <h3>Performance Focused</h3>
            <p>
              Lightweight CSS implementation with smooth animations. No JavaScript dependencies, minimal resource usage,
              and optimized for daily use.
            </p>
          </div>

          <div class="feature fade-in-up">
            <div class="feature-icon">🔧</div>
            <h3>Easy Installation</h3>
            <p>
              Multiple installation methods including automated scripts for Windows, macOS, and Linux. Get up and
              running in seconds with our deployment tools.
            </p>
          </div>

          <div class="feature fade-in-up">
            <div class="feature-icon">🌍</div>
            <h3>Cross-Platform</h3>
            <p>
              Works seamlessly across all Firefox installations. Consistent experience whether you're on Windows, macOS,
              or Linux.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Playground Section -->
    <section id="playground" class="section">
      <div class="container">
        <h2>SCSS Playground</h2>
        <p>
          Customize your findbar in real-time. Edit the SCSS configuration below and generate a link to the Sass
          Playground to see your changes live.
        </p>

        <div class="playground">
          <div class="playground-header">
            <h3>🎛️ Configuration Editor</h3>
            <div class="status" id="loadingStatus">
              <span>📡</span>
              <span>Loading SCSS...</span>
            </div>
          </div>

          <div class="playground-content">
            <div class="playground-description">
              <strong>💡 How to use:</strong>
              1) Edit the SCSS below to customize your findbar 2) Click "Generate Playground Link" to open Sass
              Playground with your config 3) Copy the generated CSS and save it as <code>chrome/findbar.css</code> in
              your Firefox profile 4) Restart Firefox to see your changes
            </div>

            <div class="code-container">
              <textarea
                id="scss"
                class="code-textarea"
                placeholder="Loading SCSS configuration..."
                spellcheck="false"
              ></textarea>
            </div>

            <div class="code-actions">
              <button id="copy" class="btn btn-outline">📋 Copy SCSS</button>
              <button id="generateLink" class="btn btn-primary">🚀 Generate Playground Link</button>
              <a href="https://sass-lang.com/playground/" target="_blank" rel="noopener" class="btn btn-secondary">
                🌐 Open Sass Playground
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Installation Section -->
    <section id="install" class="section">
      <div class="container">
        <h2>Installation Guide</h2>
        <p>Choose your preferred installation method. All methods will configure Firefox automatically.</p>

        <div class="installation">
          <h3>📦 Installation Methods</h3>
          <div class="installation-methods">
            <div class="method">
              <h4>🚀 Quick Install (Recommended)</h4>
              <ol>
                <li>Open PowerShell (Windows) or Terminal (macOS/Linux)</li>
                <li>Run the installation command:</li>
              </ol>
              <div class="code-block">
                iwr https://raw.githubusercontent.com/AlexanderReaper7/firefox-extras/main/scripts/deploy.ps1 | iex
              </div>
              <p>
                <small
                  >⚠️ Always review remote scripts before running. Requires PowerShell Core on non-Windows
                  platforms.</small
                >
              </p>
            </div>

            <div class="method">
              <h4>📁 Manual Installation</h4>
              <ol>
                <li>
                  Download <code>firefox-chrome.zip</code> from
                  <a href="https://github.com/AlexanderReaper7/firefox-extras/releases" target="_blank" rel="noopener"
                    >Releases</a
                  >
                </li>
                <li>Open Firefox profile folder (about:profiles → Open Folder)</li>
                <li>Extract the <code>chrome/</code> folder to your profile</li>
                <li>Set <code>toolkit.legacyUserProfileCustomizations.stylesheets = true</code> in about:config</li>
                <li>Restart Firefox</li>
              </ol>
            </div>

            <div class="method">
              <h4>🛠️ Development Install</h4>
              <ol>
                <li>Clone the repository:</li>
              </ol>
              <div class="code-block">git clone https://github.com/AlexanderReaper7/firefox-extras.git</div>
              <ol start="2">
                <li>Install dependencies and build:</li>
              </ol>
              <div class="code-block">npm install && npm run build</div>
              <ol start="3">
                <li>Deploy to Firefox:</li>
              </ol>
              <div class="code-block">npm run deploy:local</div>
            </div>
          </div>
        </div>

        <div class="installation">
          <h3>⚙️ Configuration Options</h3>
          <p>The findbar can be customized using SCSS variables:</p>
          <ul>
            <li><strong>$float:</strong> Enable floating/overlay mode</li>
            <li><strong>$fixed:</strong> Use fixed positioning (stays in viewport)</li>
            <li><strong>$centered:</strong> Center horizontally on the page</li>
            <li><strong>$scale:</strong> Scale factor for size (1.0 = default, 1.5 = 150%)</li>
            <li><strong>$float-alignment:</strong> Position (top, bottom)</li>
            <li><strong>$buttons-grouped:</strong> Group buttons visually with text box</li>
            <li><strong>$hide-close-button:</strong> Show/hide the close button</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-content">
          <div class="footer-section">
            <h4>Project</h4>
            <ul>
              <li>
                <a href="https://github.com/AlexanderReaper7/firefox-extras" target="_blank" rel="noopener"
                  >Source Code</a
                >
              </li>
              <li>
                <a href="https://github.com/AlexanderReaper7/firefox-extras/releases" target="_blank" rel="noopener"
                  >Releases</a
                >
              </li>
              <li>
                <a href="https://github.com/AlexanderReaper7/firefox-extras/issues" target="_blank" rel="noopener"
                  >Report Issues</a
                >
              </li>
              <li>
                <a
                  href="https://github.com/AlexanderReaper7/firefox-extras/blob/main/DEVELOPMENT.md"
                  target="_blank"
                  rel="noopener"
                  >Development</a
                >
              </li>
            </ul>
          </div>

          <div class="footer-section">
            <h4>Documentation</h4>
            <ul>
              <li>
                <a
                  href="https://github.com/AlexanderReaper7/firefox-extras/blob/main/README.md"
                  target="_blank"
                  rel="noopener"
                  >README</a
                >
              </li>
              <li><a href="#playground">SCSS Playground</a></li>
              <li><a href="#install">Installation Guide</a></li>
              <li><a href="https://sass-lang.com/playground/" target="_blank" rel="noopener">Sass Playground</a></li>
            </ul>
          </div>

          <div class="footer-section">
            <h4>Attribution</h4>
            <ul>
              <li>
                <a href="https://github.com/ravindUwU/firefox-refined-findbar" target="_blank" rel="noopener"
                  >Original Project</a
                >
              </li>
              <li><a href="https://github.com/AlexanderReaper7" target="_blank" rel="noopener">AlexanderReaper7</a></li>
              <li>
                <a
                  href="https://github.com/AlexanderReaper7/firefox-extras/blob/main/LICENSE"
                  target="_blank"
                  rel="noopener"
                  >MIT License</a
                >
              </li>
            </ul>
          </div>
        </div>

        <div class="footer-bottom">
          <p>
            &copy; 2024 Firefox Extras. Licensed under MIT. Based on and inspired by
            <a href="https://github.com/ravindUwU/firefox-refined-findbar" target="_blank" rel="noopener"
              >ravindUwU/firefox-refined-findbar</a
            >.
          </p>
        </div>
      </div>
    </footer>

    <!-- JavaScript -->
    <script>
      // Status management
      function updateStatus(text, type = 'loading') {
        const status = document.getElementById('loadingStatus');
        const icons = {
          loading: '📡',
          success: '✅',
          error: '❌',
        };

        status.innerHTML = `<span>${icons[type]}</span><span>${text}</span>`;
        status.className = `status status-${type === 'error' ? 'loading' : 'success'}`;
      }

      // Load SCSS content from the source file
      async function loadScssContent() {
        try {
          updateStatus('Loading SCSS...', 'loading');
          const response = await fetch('../src/findbar.scss');

          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }

          const scss = await response.text();
          document.getElementById('scss').value = scss;
          updateStatus('SCSS loaded successfully!', 'success');

          // Auto-hide success status after 3 seconds
          setTimeout(() => {
            updateStatus('Ready to customize', 'success');
          }, 3000);
        } catch (error) {
          console.error('Failed to load SCSS content:', error);
          updateStatus('Failed to load SCSS', 'error');

          // Fallback content
          document.getElementById('scss').value = `/* Failed to load SCSS content from ../src/findbar.scss
 * Error: ${error.message}
 * 
 * Please visit the GitHub repository to view the source:
 * https://github.com/AlexanderReaper7/firefox-extras/blob/main/src/findbar.scss
 */

// Example configuration:
@include refined-findbar(
  $float: true,
  $fixed: true,
  $centered: true,
  $scale: 1.5,
  $float-alignment: top,
  $float-distance: 18px,
  $buttons: true,
  $buttons-grouped: true
);`;
        }
      }

      // Load content when page loads
      document.addEventListener('DOMContentLoaded', loadScssContent);

      // Copy SCSS to clipboard
      document.getElementById('copy').addEventListener('click', async () => {
        const textarea = document.getElementById('scss');
        const button = document.getElementById('copy');
        const originalText = button.textContent;

        try {
          textarea.select();
          textarea.setSelectionRange(0, textarea.value.length);

          // Try modern clipboard API first
          if (navigator.clipboard && window.isSecureContext) {
            await navigator.clipboard.writeText(textarea.value);
          } else {
            // Fallback for older browsers
            document.execCommand('copy');
          }

          button.textContent = '✅ Copied!';
          button.classList.add('btn-success');

          setTimeout(() => {
            button.textContent = originalText;
            button.classList.remove('btn-success');
          }, 2000);
        } catch (error) {
          console.error('Failed to copy to clipboard:', error);
          button.textContent = '❌ Copy failed';

          setTimeout(() => {
            button.textContent = originalText;
          }, 2000);
        }
      });

      // Generate Sass Playground Link
      document.getElementById('generateLink').addEventListener('click', async () => {
        const button = document.getElementById('generateLink');
        const originalText = button.textContent;
        const scssContent = document.getElementById('scss').value;

        if (!scssContent.trim()) {
          button.textContent = '❌ No SCSS content';
          setTimeout(() => {
            button.textContent = originalText;
          }, 2000);
          return;
        }

        try {
          button.textContent = '🔄 Generating...';

          // Implementation matching the original compression logic
          async function deflateToBase64(input) {
            const encoder = new TextEncoder();
            const data = encoder.encode(input);

            // Use CompressionStream if available (modern browsers)
            if ('CompressionStream' in window) {
              const compressionStream = new CompressionStream('deflate');
              const writer = compressionStream.writable.getWriter();
              const reader = compressionStream.readable.getReader();

              writer.write(data);
              writer.close();

              const chunks = [];
              let done = false;
              while (!done) {
                const { value, done: readerDone } = await reader.read();
                done = readerDone;
                if (value) chunks.push(value);
              }

              const compressed = new Uint8Array(chunks.reduce((acc, chunk) => acc + chunk.length, 0));
              let offset = 0;
              for (const chunk of chunks) {
                compressed.set(chunk, offset);
                offset += chunk.length;
              }

              return btoa(String.fromCharCode(...compressed));
            } else {
              // Fallback: just use base64 without compression
              console.warn('CompressionStream not available, using base64 encoding without compression');
              return btoa(input);
            }
          }

          async function serializeStateContents(inputValue) {
            // Format: inputFormat(scss=1) + outputFormat(expanded=1) + content
            const persistedState = `11${inputValue}`;
            return await deflateToBase64(persistedState);
          }

          const encodedContent = await serializeStateContents(scssContent);
          const playgroundUrl = `https://sass-lang.com/playground/#${encodedContent}`;

          // Copy URL to clipboard
          if (navigator.clipboard && window.isSecureContext) {
            await navigator.clipboard.writeText(playgroundUrl);
          } else {
            // Fallback: create temporary textarea
            const temp = document.createElement('textarea');
            temp.value = playgroundUrl;
            document.body.appendChild(temp);
            temp.select();
            document.execCommand('copy');
            document.body.removeChild(temp);
          }

          button.textContent = '✅ URL Copied!';

          // Also open the playground in a new tab
          window.open(playgroundUrl, '_blank', 'noopener,noreferrer');

          setTimeout(() => {
            button.textContent = originalText;
          }, 3000);
        } catch (error) {
          console.error('Failed to generate playground link:', error);

          // Fallback: just open the playground
          button.textContent = '🌐 Opening Playground...';
          window.open('https://sass-lang.com/playground/', '_blank', 'noopener,noreferrer');

          setTimeout(() => {
            button.textContent = originalText;
          }, 2000);
        }
      });

      // Smooth scrolling for internal links
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            target.scrollIntoView({
              behavior: 'smooth',
              block: 'start',
            });
          }
        });
      });

      // Add animation classes on scroll
      const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px',
      };

      const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('fade-in-up');
          }
        });
      }, observerOptions);

      // Observe elements that should animate
      document.querySelectorAll('.feature').forEach(el => {
        observer.observe(el);
      });
    </script>
  </body>
</html>
